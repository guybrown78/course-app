define("js/data/requestFactory",["jquery","backbone"],function(e,t){function i(){this.isLocal=!1,this.apiVersion="1",this.token=null,this.centreId=null,this.developmentServicePrefix=".../api/",this.servicePrefix="...",this.loginPrefix=".../connect/",this.validationRules=null,this.localServicePrefix="../testjson/",this.getHeaders=function(){return this.isLocal||this.isNotAuth?{}:{Authorization:window.sessionStorage.getItem("token_type")+" "+window.sessionStorage.getItem("access_token"),"Content-Type":"application/json"}},this.getLoginHeaders=function(){return{Authorization:"Basic "+btoa("APPWeb:0C3404DC-C574-46C4-82DF-2B2A8922548E"),Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}},this.getServicePrefix=function(e){return e="undefined"!=typeof e?e:!0,this.isLocal?this.localServicePrefix:e?this.developmentServicePrefix+"en-GB/":this.developmentServicePrefix},this.getSerializedParams=function(e,t){return this.isLocal||t?this.buildLocalFileRequestString(e)+".json":this.buildQueryString(e)},this.buildQueryString=function(e){var t="?";for(var i in e)t+=i+"="+e[i],t+="&";return null!=this.token?t+="token="+this.token:t=t.substring(0,t.length-1),t},this.buildLocalFileRequestString=function(e){var t="/&";for(var i in e){var n=this.createLocalParamName(i);t+=n+"="+e[i],t+="&"}return t=t.substring(0,t.length-1),null!=this.token&&(t+="&to="+this.token),t},this.getPreventCacheString=function(e){if(this.isLocal)return"";var t=new Date,i=t.getTime();return e&&(i=new Date(t.getFullYear(),t.getMonth(),t.getDay()).getTime()),i},this.getPreventCacheQueryString=function(e){return"&pc="+this.getPreventCacheString(e)},this.setToken=function(e){this.token=e},this.setCurrentCentre=function(e){this.centreId=e},this.getCurrentCentre=function(){return this.centreId},this.getCentreQueryParam=function(e){switch(e){case 10:return this.getCurrentCentre()}return null},this.createLocalParamName=function(e){var t=e.length;return 8>t?e:e.substring(0,8)},this.setUpCORS=function(){if(this.isLocal===!1){e.support.cors=!0;var i=t.sync;t.sync=function(e,t,n){return n||(n={}),t.isLocal!==!0&&(n.crossDomain||(n.crossDomain=!0)),i(e,t,n)}}}}return new i}),define("js/data/models/BaseModel",["backbone"],function(e){var t=e.Model.extend({loadParams:null,isGlobal:!0,isLoading:!1,validation:{},validationRules:[],initialize:function(){this.on("success",this.onLoadSuccess),this.on("saveSuccess",this.onSaveSuccess),this.id=this.get("id")},load:function(e,t){t&&(this.loadParams=t),this.fetch(e)},update:function(t,i){t||(t={});var n=t.success,s=this;t.success=function(e,t,i){s.trigger("saveSuccess",s,e,i),n&&n(s,e,i)},"login"===s.type?t.data=$.param(i):(t.data=JSON.stringify(i),t.dataType="json",t.jsonp=!1),t.global=this.isGlobal,e.Model.prototype.save.call(this,i,t)},fetch:function(t,i){t||(t={});var n=t.success,s=this;t.success=function(e,t,i){s.trigger("success",s,e,i),n&&n(s,e,i)},t.data=i,t.global=this.isGlobal,e.Model.prototype.fetch.call(this,t)},destroy:function(t){console.log("BASE MODEL"),t||(t={});var i=t.success,n=this;t.success=function(e,t,s){n.trigger("deleteSuccess",n,e,s),i&&i(n,e,s)},t.global=this.isGlobal,e.Model.prototype.destroy.call(this,t)},searchChildren:function(e,t,i,n,s){var o=this,r=null;r=_.filter(t.models,function(t){t.get(n)===s&&e.push(t),t.get(i)&&t.get(i).length>0&&o.searchChildren(e,t.get(i),i,n,s)})},getChildMatch:function(e,t,i,n){var s=[];return this.searchChildren(s,e,t,i,n),s.length>0?s[0]:null},onLoadSuccess:function(){},onSaveSuccess:function(){},getIsAlreadyLoaded:function(){return!1},parse:function(e){for(var t in this.nestedModels){var i=this.nestedModels[t],n=e[t];e[t]=new i(n,{parse:!0})}return e},toJSON:function(e){var t=_.clone(this.attributes);if(null!==t&&(void 0===e||e===!0))for(var i in this.nestedModels)t[i]&&null!==t[i]&&_(t[i].toJSON).isFunction()&&(t[i]=t[i].toJSON());return t},getLoadOffset:function(e,t){if(null!==e){var i=e.length;return Math.ceil(i/t)+1}return 1},resetDefaults:function(){this.set(this.defaults)},nullify:function(){for(var e in this.nestedModels)this.get(e)&&_.isFunction(this.get(e).reset)&&this.get(e).reset();this.clear(),this.off()},setValidationRules:function(){}});return t}),define("js/data/collections/BaseCollection",["underscore","backbone"],function(e,t){var i=t.Collection.extend({isGlobal:!0,loadParams:null,initialize:function(){this.on("reset",this.callModelInitialisers),this.on("add",this.callModelInitialisers)},callModelInitialisers:function(t){e.each(this.models,function(e){e.init&&e.init(t)})},load:function(e,t){e.reset=!0,t&&(this.loadParams=t),this.fetch(e)},fetch:function(e){e||(e={});var i=e.success,n=this;e.success=function(e,t,s){n.trigger("success",n,e,s),i&&i(n,e,s)},e.global=this.isGlobal,t.Collection.prototype.fetch.call(this,e)},update:function(e,i){e||(e={});var n=e.success,s=this;e.success=function(e,t,i){s.trigger("saveSuccess",s,e,i),n&&n(s,e,i)},e.data=JSON.stringify(i),t.sync("update",this,e)},getIsAlreadyLoaded:function(){return!1}});return i}),define("js/data/models/errors/InvalidPropertyModel",["js/data/models/BaseModel"],function(e){var t=e.extend({type:"InvalidProperty",defaults:{domain:"",displayTitle:"",reason:"",type:""}});return t}),define("js/data/collections/errors/InvalidPropertyCollection",["js/data/collections/BaseCollection","js/data/models/errors/InvalidPropertyModel"],function(e,t){var i=e.extend({type:"InvalidProperty",model:t});return i}),define("js/data/models/ErrorModel",["js/data/models/BaseModel","js/data/collections/errors/InvalidPropertyCollection"],function(e,t){var i=e.extend({type:"Error",defaults:{code:0,displayTitle:"An unknown error has occured",displayMessage:"A data loading error has occurred please try again.",status:0,statusText:"",serviceId:"",errorAction:"generalError",errors:new t},nestedModels:{errors:t}});return i}),define("js/data/models/helpers/DeviceDetection",["js/data/models/BaseModel"],function(e){var t=e.extend({type:"DeviceDetection",defaults:{screenSize:null,screenSmall:"screenSmall",screenSmallLowestThreshold:0,screenSmallHighestThreshold:479,screenMedium:"screenMedium",screenMediumLowestThreshold:480,screenMediumHighestThreshold:959,screenLarge:"screenLarge",screenLargeLowestThreshold:960,screenLargeHighestThreshold:1/0},initialize:function(){e.prototype.initialize.apply(this),this.setScreenSize()},setScreenSize:function(e){var t;t=e?e.get("stageWidth"):$(window).width(),t<=this.get("screenSmallHighestThreshold")?this.set("screenSize",this.get("screenSmall")):t>=this.get("screenMediumLowestThreshold")&&t<=this.get("screenMediumHighestThreshold")?this.set("screenSize",this.get("screenMedium")):t>=this.get("screenLargeLowestThreshold")&&this.set("screenSize",this.get("screenLarge"))},getScreenSize:function(){return this.setScreenSize(),this.get("screenSize")},isScreenSizeSmall:function(){return this.getScreenSize()===this.get("screenSmall")},isScreenSizeMedium:function(){return this.getScreenSize()===this.get("screenMedium")},isScreenSizeLarge:function(){return this.getScreenSize()===this.get("screenLarge")}});return t}),define("js/data/models/helpers/ScreenSizeDetection",["js/data/models/BaseModel"],function(e){var t=e.extend({type:"ScreenSizeDetection",defaults:{stageHeight:null,stageWidth:null},initialize:function(){e.prototype.initialize.apply(this),$(window).on("resize",_.bind(this.onScreenResize,this)),this.onScreenResize()},onScreenResize:function(){this.set("stageHeight",Number($(window).height())),this.set("stageWidth",Number($(window).width())),this.trigger("screen:resize")}});return t}),define("js/data/dataStore",["jquery","backbone","js/data/requestFactory","js/data/models/ErrorModel","js/data/models/helpers/DeviceDetection","js/data/models/helpers/ScreenSizeDetection"],function(e,t,i,n,s,o){var r=t.Model.extend({hasCheckedLocalStorage:!1,isLoading:!0,login:null,dataError:null,deviceDetection:null,screenSizeDetection:null,parentRoute:null,isLoginPage:!1,filestoreViewPreference:"grid",initialSetUpLoadComplete:!1,initialize:function(){this.set("dataError",new n),this.set("deviceDetection",new s),this.set("screenSizeDetection",new o),this.get("deviceDetection").listenTo(this.get("screenSizeDetection"),"change:stageWidth",this.get("deviceDetection").setScreenSize,this.get("screenSizeDetection")),e(window).on("storage",_.bind(this.onStorageChange,this)),window.localStorage.setItem("getSessionStorageValue",Date.now()),window.localStorage.removeItem("getSessionStorageValue"),setTimeout(this.onStorageInitialisedTimeout,250),i.setUpCORS(),this.initAjaxErrorHandler()},onStorageInitialisedTimeout:function(t){this.hasCheckedLocalStorage||e(window).trigger("storage")},onStorageChange:function(e){if(e.originalEvent)if("setSessionStorageValue"===e.originalEvent.key)window.localStorage.setItem("getSessionStorageValue",Date.now()),window.localStorage.removeItem("getSessionStorageValue");else if("getSessionStorageValue"===e.originalEvent.key)window.localStorage.setItem("sessionValues",JSON.stringify(window.sessionStorage)),window.localStorage.removeItem("sessionValues");else if("sessionValues"===e.originalEvent.key&&null!==e.originalEvent.newValue){var t=JSON.parse(e.originalEvent.newValue);for(key in t)window.sessionStorage.setItem(key,t[key]);this.get("login").getSavedTokenValues()}else"logout"===e.originalEvent.key?(this.get("login").revokeAuthorization(),this.initiateLogout()):"timeout"===e.originalEvent.key&&this.revokeUser();else;this.hasCheckedLocalStorage=!0,this.trigger("store:storageInitialised")},initialiseCredentials:function(){window.localStorage.setItem("setSessionStorageValue",Date.now()),window.localStorage.removeItem("setSessionStorageValue")},loadInSequence:function(e,t){if(e.length){if(t=e.shift(),null===t)throw this.isLoading=!1,new Error("DataStore.loadInSequence(): model not found");if(t.getIsAlreadyLoaded())_(t.init).isFunction()&&t.init(),this.loadSuccess(e,t);else{var i=this,n=this.getBasicLoadOptions();n.success=_.bind(this.loadSuccess,i,e,t),this.loadStart(),t.load(n)}}else this.isLoading=!1,this.loadSequenceComplete(t)},getBasicLoadOptions:function(){var e={headers:i.getHeaders(),timeout:3e5};return e},loadStart:function(){this.isLoading=!0,this.trigger("store:loadStart")},loadSuccess:function(e,t){this.loadInSequence(e,t)},loadSequenceComplete:function(e){this.isLoading=!1;var t="store:";t+="update",this.trigger(t)},loadData:function(e,t){this.loadEvent=t,this.loadInSequence(e)},checkUserLoad:function(e){},loadError:function(e){this.isLoading=!1,this.get("dataError").clear(),this.get("dataError").set(e),this.trigger("store:error")},onCentreChange:function(e){},initAjaxErrorHandler:function(){var t=this;e(document).ajaxError(function(e,i,n,s){t.loadError(t.getStatusError(i,s))})},getStatusError:function(e,t){var i={};if(e.status&&null!==e.status){var n=e.responseJSON,s=n&&null!==n&&(n.code&&n.code>0||400===e.status&&n.error_description);i=s?this.populateServerErrorMessage(e.status,e.statusText,n):this.populateLocalErrorMessage(e.status,e.statusText,n)}else console.log("non http status error"),i=this.getNonHTTPStatusError(t);return i},populateServerErrorMessage:function(e,t,i){var n={};return n.status=e,n.statusText=t,400===e?(n.code=e,n.displayTitle=i.error,n.displayMessage=i.error_description):(n.displayMessage=i.displayMessage,n.displayTitle=i.displayTitle,n.code=i.code,n.errors=i.errors),400===e||401===e?n.errorAction="timeoutUser":403===e&&(n.errorAction="userWithoutCredentials"),n},populateLocalErrorMessage:function(e,t,i){var n={};switch(n.status=e,n.statusText=t,n.code=e,e){case 0:return this.getNonHTTPStatusError("timeout");case 400:n.code=400,n.displayMessage="An error has occured with the login",n.displayTitle=t,n.errorAction="timeoutUser";break;case 401:n.displayMessage="Unauthorised response",n.displayTitle="Not a valid login",n.errorAction="timeoutUser";break;case 403:n.displayMessage="You are not authorised to view this page",n.displayTitle="Invalid credentials",n.errorAction="userWithoutCredentials";break;default:console.log("500 - 404 - 406 - 422"),n.displayMessage=t,n.displayTitle="An error has occured",n.status=e,n.statusText=t}return n},getNonHTTPStatusError:function(e){var t="This page is currently unavailable.",i="An unknown error has occured",n=e,s=0;switch(e){case"parsererror":i="Error: Unexpected data.",t="The data cannot be read";break;case"timeout":i="The data call has timed out, please try again";break;case"abort":i="The data call has aborted, please try again";break;case"error":i="The data call has failed, this may be due to a lost connection. Please check your network or wifi settings and try again"}return{status:s,displayMessage:t,displayTitle:i,statusText:n,code:s}},getCustomDataError:function(e,t){var i=this.getStatusError(e,t);return(400===i.status||401===i.status||403===i.status)&&this.loadError(i),new n(i,{parse:!0})},initiateLogout:function(){window.location="../login/index.html#/logout"},dataLogout:function(){this.clearUser(),this.get("login").isLogout=!1,this.get("login").resetDefaults(),this.get("login").revokeAuthorization()},clearUser:function(){this.set("userId",null),this.set("userSession",null),this.set("userSession",new UserSessionModel)},revokeUser:function(){this.clearUser(),this.get("login").revokeAuthorization(),this.trigger("store:revokeUser"),window.location="../login/index.html#/login"},returnToDefaultPage:function(){window.location="../login/index.html#/selectRole"},handleErrorAction:function(e){switch(e.get("errorAction")){case"timeoutUser":window.localStorage.setItem("timeout",Date.now()),window.localStorage.removeItem("timeout"),this.revokeUser();break;case"revokeUser":this.revokeUser();break;case"userWithoutCredentials":this.returnToDefaultPage()}}});return r}),define("js/data/models/tree/BaseTreeModel",["js/data/requestFactory","js/data/models/BaseModel","js/data/collections/BaseCollection"],function(e,t,i){var n=t.extend({type:"Tree",childrenLoaded:!1,parentModel:null,rootModel:null,additionalIds:null,idAttribute:"itemId",requiresReload:!1,defaults:{itemId:null,displayName:"",genericCount:0,parentId:null,depth:0,childrenCount:0,canEdit:!0,isOpen:!1,isSelected:!1,children:null},initialize:function(){this.listenTo(this,"change:isSelected",this.onItemSelected,this),t.prototype.initialize.apply(this)},url:function(){var e="../testjson/tree";return"getChildren"===this.loadParams.loadType&&(e+="-item-"+this.loadParams.itemId),e+=".json",console.log("json static url = "+e),e},parse:function(e){return e.children||(e.children=[]),this.parseChildren(e)},parseChildren:function(e){return this.get("children")&&this.get("children").length>0?(this.additionalIds=_.pluck(e.children,"itemId"),this.get("children").add(e.children,{parse:!0}),e=_.omit(e,"children")):e.children=new i(e.children,{parse:!0,model:this.constructor}),e},resetChildren:function(){null!==this.get("children")&&(this.get("children").reset(),this.childrenLoaded=!1)},getLoadOffset:function(){if(null!==this.get("children")){var e=this.get("children").length;return Math.ceil(e/this.rootModel.get("limit"))+1}return 1},onLoadSuccess:function(){this.setParentModels(),this.get("children").length===this.get("childrenCount")&&(this.childrenLoaded=!0)},setParentModels:function(){var e=this;_.each(this.get("children").models,function(t){t.parentModel=e,t.rootModel=e.rootModel})},toggleOpenItemChildren:function(e){_.each(this.get("children").models,function(t){t.set("isOpen",e)})},toggleOpenNestedChildren:function(e){this.set("isOpen",e),_.each(this.get("children").models,function(t){t.toggleOpenNestedChildren(e)})},onItemSelected:function(){},getIsAlreadyLoaded:function(){return!1},destroy:function(e){this.loadParams.loadType="delete",t.prototype.destroy.apply(this,[e])},getTreeItem:function(e){return this.get("itemId")===e?this:this.getChildMatch(this.get("children"),"children","itemId",e)},nestedModels:{children:i}});return n}),define("dataStore",["js/data/dataStore","js/data/models/tree/BaseTreeModel"],function(e,t){var i=e.extend({defaults:{tree:null},initialize:function(){e.prototype.initialize.apply(this),this.set("tree",new t)}});return new i}),define("js/router",["jquery","underscore","backbone","dataStore"],function($,_,Backbone,dataStore){var BaseRouter=Backbone.Router.extend({currentView:null,initialize:function(){},execute:function(e,t,i){return dataStore.hasCheckedLocalStorage?void(e&&e.apply(this,t)):(this.executeArgument=[e,t,i],this.listenTo(dataStore,"store:storageInitialised",this.onDataStoreInitialised,this),!1)},onDataStoreInitialised:function(){this.stopListening(dataStore,"store:storageInitialised"),this.execute(this.executeArgument[0],this.executeArgument[1],this.executeArgument[2]),this.executeArgument=null},showApplicationSetup:function(){console.log("SHOW APPLICATION SETUP"),null!==this.currentView&&this.currentView.destroy(),this.currentView=null,this.currentView=new ApplicationSetUpPageView,this.listenTo(dataStore,"setUp:complete",this.onInitialSetUpComplete),this.currentView.render()},onInitialSetUpComplete:function(e){window.location.hash=this.nextLocation},switchView:function(e,t,i,n){if(View=this.referenceView(e),!View)throw new Error("Invalid view");null!==this.currentView&&this.currentView.destroy(),this.currentView=null;var s={viewType:t};null!==i&&(s.model=i),this.currentView=new View(s),document.body.scrollTop=document.documentElement.scrollTop=0,this.currentView.render()},viewExists:function(e){if("string"==typeof e&&this.switchableViews.indexOf(unescape(e))>-1)return!0;throw new Error("View not found")},parseQueryString:function(e){var t={};return e&&_.each(_.map(decodeURI(e).split(/&/g),function(e,t){var i=e.split("="),n={};if(i.length>=1){var s=void 0;2==i.length&&(s=i[1]),n[i[0]]=s}return n}),function(e){_.extend(t,e)}),t},referenceView:function(View){return"function"==typeof View?View:this.viewExists(View)?eval(View):!1}});return BaseRouter}),define("js/views/BaseView",["jquery","underscore","backbone"],function(e,t,i){var n=i.View.extend({baseItemClickDebounceTimeout:null,baseItemClickDebounceTime:250,render:function(){t.defer(t.bind(this.postRender,this))},postRender:function(){},baseOnItemClickedHandler:function(e){var t=this;return this.baseItemClickDebounceTimeout?(this.baseClearItemClickedDefer(),this.onItemDoubleClickedHandler(e),!1):void(this.baseItemClickDebounceTimeout=setTimeout(function(){t.baseItemClickedDefer(e)},t.baseItemClickDebounceTime))},baseClearItemClickedDefer:function(){clearTimeout(this.baseItemClickDebounceTimeout),this.baseItemClickDebounceTimeout=null},baseItemClickedDefer:function(e){this.baseClearItemClickedDefer(),this.onItemSingleClickedHandler(e)},onItemSingleClickedHandler:function(e){},onItemDoubleClickedHandler:function(e){},appendSubViewsToElement:function(e,i,n,s,o,r){var a=[],l=void 0!==r?r:{};return t.each(i,function(t){l.model=t;var i=new n(l);a.push(i),i.render(),e.append(i.el)}),a},destroyAppendedViews:function(e){for(var t;e.length>0;)t=e.shift(),t.destroy(),t=null;return e=null,[]},stripDataIdFromElementId:function(e,t){t||(t="-");var i=e.attr("id").split(t);return i[i.length-1]},getNoDataMessageHTML:function(e){var t="<div class='no-data'>";return t+=e,t+="</div>"},getDataErrorMessageHTML:function(e,t){var i="<div class='data-error'>";return null!==t&&(i+="<h5>"+t+"</h5>"),i+=e,i+="</div>"},setContentsHeightFromParentOffset:function(e,t,i,n){i||(i="height"),n||(n=!0);var s=Math.floor(e.outerHeight()-this.getContentsOffsetFromParentOffset(e,t));n&&(s-=Number(t.css("padding-bottom").replace("px",""))),t.css(i,s)},getContentsOffsetFromParentOffset:function(e,t){return Math.floor(t.offset().top-e.offset().top)},onUndevelopedMessageAlert:function(){this.onAlert("This functionality has not yet been developed","Not Available")},enableActionButton:function(e){e.removeClass("disabled"),e.removeProp("disabled")},disableActionButton:function(e){e.addClass("disabled"),e.prop("disabled",!0)},destroyModel:function(){this.model&&(this.model.stopListening(),this.model=null)},destroyView:function(){this.remove(),this.unbind()},destroyEl:function(){this.$el.empty(),this.$el.remove()},destroy:function(){this.destroyModel(),this.destroyView(),this.destroyEl(),this.baseClearItemClickedDefer(),this.onDestroy&&this.onDestroy()}});return n}),define("js/views/BaseLoadingView",["dataStore","js/views/BaseView","spinner"],function(e,t,i){var n=t.extend({dataRequested:!1,title:"",viewType:"",initialLoadRenderRenderComplete:!1,showSpinner:!0,spinnerCurrentlyVisable:!1,loaderOptions:{lines:8,length:0,width:7,radius:10,corners:20,rotate:0,color:"#008080",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9},initialize:function(e){t.prototype.initialize.apply(this),this.viewNumber=Math.floor(9999901*Math.random())+100,this.loaderElId||(this.loaderElId=this.el),this.jqueryEL=$(this.el),this.name&&(this.loaderOptions.className=this.loaderOptions.className+"-"+this.name)},render:function(){if(this.initialLoadRenderRenderComplete||(this.initialLoadRenderRenderComplete=!0,this.initialLoadRender()),this.dataRequested)this.removeSpinner(),this.renderViewContent(),this.initialiseLoaderElIdReference();else{this.showLoader(),this.dataRequested=!0;var e=[];this.requestData(e)}return t.prototype.render.apply(this),this},requestData:function(t){e.checkUserLoad(t),t.length>0?e.loadData(t):this.render()},initialLoadRender:function(){},renderViewContent:function(){},initialiseLoaderElIdReference:function(){this.loaderElId=$(this.loaderElId)},showLoader:function(){if(this.showSpinner){this.removeSpinner();var e=new i(this.loaderOptions).spin();"."+this.loaderOptions.className;this.spinnerCurrentlyVisable=!0,$(this.loaderElId).append(e.el),this.spinnerEL=$(this.loaderElId).find(String("."+this.loaderOptions.className)),this.positionSpinner()}},removeSpinner:function(){this.spinnerEL&&this.spinnerCurrentlyVisable&&(this.spinnerEL.empty().detach(),this.spinnerCurrentlyVisable=!1)},positionSpinner:function(){if(this.spinnerEL&&this.showSpinner){this.spinnerEL.css("position","absolute");var e=Math.floor($(this.loaderElId).outerWidth()/2+$(this.loaderElId).offset().left);this.spinnerEL.css("left",e+"px");var t=Math.floor($(this.loaderElId).outerHeight()/2+$(this.loaderElId).offset().top)+this.getScrollTop();this.spinnerEL.css("top",t+"px")}},getScrollTop:function(){if("undefined"!=typeof pageYOffset)return pageYOffset;var e=document.body,t=document.documentElement;return t=t.clientHeight?t:e,t.scrollTop},onDataLoadError:function(t,i,n,s){this.removeSpinner&&this.removeSpinner();var o=e.getCustomDataError(i,s);this.showLoadErrorMessage(o)},showLoadErrorMessage:function(){}});return n}),define("js/views/PageView",["dataStore","js/views/BaseLoadingView"],function(e,t){var i=t.extend({el:"#pageContent",contentPadding:null,footerHeight:0,loaderElId:"#pageContent",initialize:function(i){t.prototype.initialize.apply(this),e.isLoginPage=!1,this.events=_.extend({},t.prototype.events,this.events),this.listenTo(e,"store:update",this.onDataLoad,this),this.listenTo(e,"store:error",this.onDataLoadError,this),this.listenTo(e.get("screenSizeDetection"),"change:stageHeight",this.onResize,this)},destroyDataStoreListeners:function(){this.stopListening(e,"store:update"),this.stopListening(e,"store:error"),this.stopListening(e.get("screenSizeDetection"),"change:stageHeight"),this.stopListening(e,"error:login")},destroyView:function(){this.unbind(),this.undelegateEvents(),this.stopListening()},destroyEl:function(){this.$el.empty()},destroy:function(){this.destroyDataStoreListeners(),t.prototype.destroy.apply(this)},onDataUpdate:function(e){this.render()},renderViewContent:function(){this.renderPageContent(),null!==e.get("screenSizeDetection").get("stageHeight")&&null!==this.contentPadding?this.setPageContentHeight():this.onResize()},renderPageContent:function(){},onResize:function(){this.contentPadding=Number(this.jqueryEL.css("padding-top").replace("px",""))+Number(this.jqueryEL.css("padding-bottom").replace("px","")),this.footerHeight=this.getFooterHeight(),this.setPageContentHeight(),this.positionSpinner()},onHeaderUpdate:function(){this.onResize()},setPageContentHeight:function(){var t=Math.floor(e.get("screenSizeDetection").get("stageHeight")-(this.jqueryEL.offset().top+this.contentPadding))-this.footerHeight;this.jqueryEL.css("min-height",t),this.setAdditionalPageItemsHeight(t)},setAdditionalPageItemsHeight:function(e){},getFooterHeight:function(){var e=document.getElementsByTagName("footer");return e.length?e[0].offsetHeight:0},onDataLoad:function(e){this.render()},onDataLoadError:function(){this.removeSpinner&&this.removeSpinner();e.get("dataError")}});return i}),define("text!js/views/sectionsStack/SectionsStackLayout.html",[],function(){return'<article id="<%=articleId%>" class="page-container section-stack">\r\n\r\n    <header>\r\n        <h2><%=pageTitle%></h2>\r\n    </header>\r\n\r\n    <div class="grid <%=gridClass%> <%=gridType%>" data-focused-item-ordinal="<%=sectionsStack[currentFocusedIndex].ordinal%>" data-focused-index="<%=currentFocusedIndex%>">\r\n        <% _.each(sectionsStack, function(item, index){ %>\r\n        <div class="flex-column <%=item.class%>" data-item-ordinal="<%=item.ordinal%>" data-index="<%=index%>">\r\n            <!--<section class="section-stack-item">\r\n\r\n            </section>-->\r\n        </div>\r\n        <% }) %>\r\n    </div>\r\n    \r\n</article>'}),define("text!js/views/sectionsStack/section/BaseSection.html",[],function(){return'<% if(index > 0) { %>\r\n<div class="action-button toggle-open-close" type="button">\r\n    <div class="arrow closed"></div>\r\n</div>\r\n<% } %>\r\n<div class="section-stack-container">\r\n    <% if(showHeader) { %>\r\n    <header></header>\r\n    <% } %>\r\n    <div class="content"></div>\r\n</div>\r\n\r\n'}),define("text!js/views/sectionsStack/section/BaseSectionHeader.html",[],function(){return'<div class="cel-title">\r\n    <h3><%=displayName%></h3>\r\n</div>'}),define("js/views/sectionsStack/section/BaseSectionView",["dataStore","js/views/BaseLoadingView","text!js/views/sectionsStack/section/BaseSection.html","text!js/views/sectionsStack/section/BaseSectionHeader.html"],function(e,t,i,n){var s=t.extend({name:"BaseSection",title:"Section title",model:null,template:null,headerTemplate:null,showHeader:!0,index:null,isOpen:!1,restrictHeightToScreen:!1,topOffset:0,contentOffset:0,verticalPadding:0,sectionBottomPadding:0,sectionEL:null,contentEL:null,openCloseButtonEL:null,openCloseButtonWidth:30,rendered:null,nullModelMessage:"There is currently no item selected",initialize:function(e){this.events=_.extend({},s.prototype.events,this.events),t.prototype.initialize.apply(this),this.initialiseViewParametersFromOptions(e),this.initialiseLayoutTemplate(),this.initialiseHeaderTemplate(),null!==this.model&&this.initialiseModelListeners()},initialiseViewParametersFromOptions:function(e){void 0!==e.isOpen&&(this.isOpen=e.isOpen),void 0!==e.showHeader&&(this.showHeader=e.showHeader),void 0!==e.title&&(this.title=e.title),void 0!==e.restrictHeightToScreen&&(this.restrictHeightToScreen=e.restrictHeightToScreen)},initialiseLayoutTemplate:function(){this.template=_.template(i)},initialiseHeaderTemplate:function(){this.headerTemplate=_.template(n)},events:{"click .toggle-open-close":"onOpenCloseToggle"},render:function(){$(this.el).html(this.template(this.getTemplateData())),this.sectionEL=$(this.el).find(".section-stack-container"),t.prototype.render.apply(this)},getTemplateData:function(){var e={};return e.showHeader=this.showHeader,e.index=this.index,e},postRender:function(){this.index>0&&(this.openCloseButtonEL=$(this.el).find(".action-button.toggle-open-close"),this.openCloseButtonWidth=this.openCloseButtonEL.outerWidth()),this.contentEL=$(this.el).find(".content").first(),this.initialiseViewCalculations(),this.rendered=!0,this.isOpen?this.renderSection():(this.close(),this.height&&this.setHeight(this.height));var e=document.getElementsByClassName("flex-column")[this.index],t=this;this.prefixedEventListener(e,"transitionEnd",function(e){t.onTransistionComplete(e)})},prefixedEventListener:function(e,t,i){for(var n=["webkit","moz","MS","o",""],s=0;s<n.length;s++)n[s]||(t=t.toLowerCase()),e.addEventListener(n[s]+t,i,!1)},onTransistionComplete:function(e){e.stopPropagation(),this.initialiseViewCalculations(),this.height&&this.setHeight(this.height)},initialiseViewCalculations:function(){this.verticalPadding=Number($(this.el).css("padding-top").replace("px",""))+Number($(this.el).css("padding-bottom").replace("px","")),this.contentEL.offset().top>0&&(this.contentOffset=Math.ceil(this.contentEL.offset().top-$(this.el).offset().top)),this.sectionBottomPadding=Number($(this.sectionEL).css("padding-bottom").replace("px",""))},renderSection:function(){this.isOpen||this.onOpenCloseToggle(),this.sectionEL.find("header").html(this.headerTemplate(this.getHeaderTemplateData())),this.renderSectionsContent(),this.initialiseViewCalculations(),this.height&&this.setHeight(this.height)},renderSectionsContent:function(){null!==this.model?this.contentEL.html("Rendered :)"):this.contentEL.html(this.getNoDataMessageHTML(this.nullModelMessage))},getHeaderTemplateData:function(){var e={};return null!==this.model?e=this.model.toJSON():e.displayName=this.title,e},onDataLoadError:function(t,i,n,s){e.getCustomDataError(i,s),n.loadType},updateModel:function(e){this.destroyModel(),this.model=e,this.initialiseModelListeners(),this.renderSection()},onOpenCloseToggle:function(e){this.isOpen?(this.isOpen=!1,this.close()):(this.isOpen=!0,this.open(),this.renderSection()),this.trigger("sectionStackView:openClose",this.isOpen?"open":"close",this.index)},close:function(){this.openCloseButtonEL.find(".arrow").removeClass("open").addClass("closed"),this.sectionEL.addClass("closed")},open:function(){this.openCloseButtonEL.show(),this.openCloseButtonEL.find(".arrow").removeClass("closed").addClass("open"),this.sectionEL.removeClass("closed")},setTopOffset:function(e){this.topOffset=e,$(this.el).css("margin-top",this.topOffset>0?this.topOffset+this.verticalPadding:this.topOffset+"px")},setHeight:function(e){if(this.height=e,this.rendered){var t=this.topOffset>0?this.height-this.verticalPadding:this.height,i=t-(this.contentOffset+this.verticalPadding);this.sectionBottomPadding>0&&(i-=this.sectionBottomPadding),this.restrictHeightToScreen?(this.sectionEL.css("height",t-this.verticalPadding+"px"),this.contentEL&&(this.contentEL.css("height",i+"px"),this.setAdditionalViewItemHeights(i))):this.setAdditionalViewItemHeights(i)}},setAdditionalViewItemHeights:function(e){},initialiseModelListeners:function(){},removeModelListeners:function(){},destroyModel:function(){null!==this.model&&this.removeModelListeners(),t.prototype.destroyModel.apply(this)},destroy:function(){this.template=null,this.name=null,this.el=null,t.prototype.destroy.apply(this)}});return s}),define("js/views/sectionsStack/BaseSectionsStackPageView",["dataStore","js/views/PageView","text!js/views/sectionsStack/SectionsStackLayout.html","js/views/sectionsStack/section/BaseSectionView"],function(e,t,i,n){var s=t.extend({name:"Base sections stack page view",articleId:"basePageSectionsStackContent",gridClass:"page-section-stack-grid",gridType:"dual-focus",currentDefaultFocusedIndex:0,currentFocusedIndex:0,sectionsStack:null,topOffset:0,enableSliding:!1,gridEL:null,elementsOffsetY:null,renderedPageContent:!1,initialize:function(i){t.prototype.initialize.apply(this,[i]),e.isLoading=!1,this.initialiseLayoutTemplate(),this.initialiseModel(),this.sectionsStack=[],this.initialiseSectionsStack(),this.listenTo(e.get("deviceDetection"),"change:screenSize",this.onDeviceDetectionChange,this),this.listenTo(e.get("screenSizeDetection"),"change:stageWidth",this.onStageWidthResize,this),this.enableSliding=this.getEnableSliding(),$(window).on("scroll",_.bind(this.onScroll,this))},initialiseLayoutTemplate:function(){this.template=_.template(i)},initialiseModel:function(){},initialiseSectionsStack:function(){this.sectionsStack.push({view:new n({
isOpen:!0,restrictHeightToScreen:!1,showHeader:!1}),"class":"primary",ordinal:1}),this.sectionsStack.push({view:new n({isOpen:!1,restrictHeightToScreen:!0}),"class":"secondary",ordinal:2})},getEnableSliding:function(){return"slider"===this.gridType?!0:"screenLarge"!==e.get("deviceDetection").get("screenSize")?!0:this.sectionsStack.length>2?!0:!1},setEnableSliding:function(e){var t=e!==this.enableSliding;this.enableSliding=e,t&&this.slideToSection(this.currentFocusedIndex,!1)},events:{},renderPageContent:function(){$(this.el).html(this.template(this.getTemplateData())),this.gridEL=$(this.el).find(".grid."+this.gridClass),this.initialiseViewCalculations(),this.initialiseSectionsStackViews(),this.renderedPageContent=!0,this.delegateEvents()},getTemplateData:function(){var e={};return e.pageTitle=this.name,e.articleId=this.articleId,e.sectionsStack=this.sectionsStack,e.gridClass=this.gridClass,e.gridType=this.gridType,e.currentFocusedIndex=this.currentFocusedIndex,e},initialiseSectionsStackViews:function(){var e=this;_.each(this.sectionsStack,function(t,i){e.addSectionsStackViewsListeners(t.view,i),t.view.setElement(e.gridEL.find('[data-item-ordinal="'+t.ordinal+'"]')),t.view.index=i,t.view.render()})},addSectionsStackViewsListeners:function(e,t){switch(t){case 0:this.listenTo(e,"sectionStackView:itemSelect",this.onSectionItemSelected,this);break;case 1:this.listenTo(e,"sectionStackView:openClose",this.onSectionViewOpenClose,this)}},removeSectionsStackViewsListeners:function(e,t){switch(t){case 0:this.stopListening(e,"sectionStackView:itemSelect",this.onSectionItemSelected);break;case 1:this.stopListening(e,"sectionStackView:openClose",this.onSectionViewOpenClose)}},onHeaderUpdate:function(){this.initialiseViewCalculations(),this.setAdditionalPageItemsHeight()},onDeviceDetectionChange:function(){this.initialiseViewCalculations(),this.updateNodeDetailsView(),this.setAdditionalPageItemsHeight()},initialiseViewCalculations:function(){this.elementsOffsetY=null!==this.gridEL?Math.ceil($(this.gridEL).offset().top):0},onStageWidthResize:function(){this.enableSliding&&this.currentFocusedIndex>0&&this.slideToSection(this.currentFocusedIndex,!1)},setAdditionalPageItemsHeight:function(e){this.setSectionsStackViewHeights()},setSectionsStackViewHeights:function(t){if(t=void 0===t?$(window).scrollTop():t,this.renderedPageContent){var i=e.get("screenSizeDetection").get("stageHeight")-this.elementsOffsetY+(t-this.topOffset);this.gridEL.css("min-height",i),_.each(this.sectionsStack,function(e,t){e.view.setHeight(i)})}},onScroll:function(){if(this.renderedPageContent){var e=$(window).scrollTop();this.topOffset=e-this.elementsOffsetY,this.topOffset<0&&(this.topOffset=0);var t=this;_.each(this.sectionsStack,function(e,i){e.view.restrictHeightToScreen&&e.view.setTopOffset(t.topOffset)}),this.setSectionsStackViewHeights(e)}},updateNodeDetailsView:function(){this.setEnableSliding(!0)},onSectionViewOpenClose:function(e,t){0!==t&&("close"===e?this.currentFocusedIndex=t-1:this.currentFocusedIndex=t),this.gridEL.removeData("data-focused-item-ordinal"),this.gridEL.removeData("data-focused-index"),this.gridEL.attr("data-focused-item-ordinal",this.sectionsStack[this.currentFocusedIndex].ordinal),this.gridEL.attr("data-focused-index",this.currentFocusedIndex),this.enableSliding&&this.slideToSection(this.currentFocusedIndex)},onSectionItemSelected:function(e,t){},slideToSection:function(e,t){if(this.renderedPageContent){var i=this.gridEL.innerWidth(),n=i*e;t=void 0===t?!0:t,t?this.gridEL.animate({scrollLeft:n}):this.gridEL.scrollLeft(n)}},destroyDataStoreListeners:function(){this.stopListening(e.get("deviceDetection"),"change:screenSize"),this.stopListening(e.get("screenSizeDetection"),"change:stageWidth"),t.prototype.destroyDataStoreListeners.apply(this)},destroySectionsStackViews:function(){var e=this;_.each(this.sectionsStack,function(t,i){e.removeSectionsStackViewsListeners(t.view,i),t.view.destroy(),t.view=null})},destroySectionsStack:function(){this.destroySectionsStackViews();for(var e;this.sectionsStack.length>0;)e=this.sectionsStack.shift(),e=null;this.sectionsStack=[]},destroy:function(){this.destroySectionsStack(),t.prototype.destroy.apply(this)}});return s}),define("text!js/views/tree/TreeView.html",[],function(){return'<%= nodeItemTemplate %>\r\n<% if(childrenCount > 0){ %>\r\n<ul class="tree-node-item-children"></ul>\r\n<% } %>\r\n\r\n'}),define("text!js/views/tree/TreeNodeItem.html",[],function(){return'<div class="tree-node-item" data-id="<%=itemId%>">\r\n    <div class="cel-depth" style="width: <%= depth * depthIndent %>px"></div>\r\n    <% if(childrenCount > 0){ %>\r\n    <div class="cel-arrow">\r\n        <div class="<% if( isOpen == true ){ %>open<% } else { %>closed<% } %>"></div>\r\n    </div>\r\n    <% } %>\r\n    <div class="cel-display-name active-select-area">\r\n        <%= displayName %>\r\n    </div>\r\n    <div class="cel-generic-count active-select-area">\r\n        <%= genericCount %>\r\n    </div>\r\n</div>'}),define("js/views/tree/TreeView",["dataStore","js/views/BaseLoadingView","text!js/views/tree/TreeView.html","text!js/views/tree/TreeNodeItem.html"],function(e,t,i,n){var s=t.extend({tagName:"li",collapseSpeed:250,depthIndent:10,childTreeViews:null,nodeItemTemplate:n,nodeItemHeight:30,nodeItemEL:".tree-node-item",nodeChildrenEL:".tree-node-item-children",openCloseNodeItem:!0,openCloseArrowOnly:!1,arrowEL:".cel-arrow",showArrowEL:!0,loadChildrenInternally:!0,isModelLoading:!1,additionalNodeStateParams:null,additionalNodeStateValue:null,additionalNodeStateSelector:"",additionalModelListenersHandlers:null,additionalRenderFunction:null,specifyDepth:!0,initialize:function(e){if(t.prototype.initialize.apply(this),e||"object"==typeof e?(this.options=e,this.setOptionParams()):this.template=_.template(i),this.treeView=s,this.childTreeViews=[],this.model.bind("change:children",this.onChildrenLoaded,this),this.listenTo(this.model,"change:isSelected",this.onSelectedStateChange,this),this.listenTo(this.model,"deleteSuccess",this.onItemDelete,this),this.listenTo(this.model,"change:"+this.additionalNodeStateParams,this.onAdditionalNodeStateParamsChange,this),this.additionalModelListenersHandlers&&this.additionalModelListenersHandlers.length>0){var n=this;_.each(this.additionalModelListenersHandlers,function(e){n.listenTo(n.model,e.listener,e.handler,n)})}this.model.set("viewReference",this),this.name="treeview"},setOptionParams:function(){this.template=void 0===this.options.template?_.template(i):_.template(this.options.template),this.collapseSpeed=void 0===this.options.collapseSpeed?this.collapseSpeed:parseInt(this.options.collapseSpeed,10),void 0!==this.options.openCloseArrowOnly&&(this.openCloseArrowOnly=this.options.openCloseArrowOnly),void 0!==this.options.openCloseNodeItem&&(this.openCloseNodeItem=this.options.openCloseNodeItem),void 0!==this.options.nodeItemTemplate&&(this.nodeItemTemplate=this.options.nodeItemTemplate),void 0!==this.options.nodeItemHeight&&(this.nodeItemHeight=this.options.nodeItemHeight),void 0!==this.options.arrowEL&&(this.arrowEL=this.options.arrowEL),void 0!==this.options.loadChildrenInternally&&(this.loadChildrenInternally=this.options.loadChildrenInternally),this.getChildrenLoadParams=void 0===this.options.getChildrenLoadParams?{}:this.options.getChildrenLoadParams,void 0!==this.options.additionalNodeStateParams&&(this.additionalNodeStateParams=this.options.additionalNodeStateParams,this.additionalNodeStateValue=this.options.additionalNodeStateValue,this.additionalNodeStateSelector=this.options.additionalNodeStateSelector),void 0!==this.options.specifyDepth&&(this.specifyDepth=this.options.specifyDepth),void 0!==this.options.additionalModelListenersHandlers&&(this.additionalModelListenersHandlers=this.options.additionalModelListenersHandlers),void 0!==this.options.additionalRenderFunction&&(this.additionalRenderFunction=this.options.additionalRenderFunction)},events:{},initialiseEvents:function(){var e=this;this.openCloseNodeItem?this.model.get("childrenCount")>0&&$(this.el).find(" > "+this.nodeItemEL).click(function(){return e.onNodeItemSelected()}):this.openCloseArrowOnly&&this.model.get("childrenCount")>0&&$(this.el).find(" > "+this.nodeItemEL).find(" > "+this.arrowEL).click(function(){return e.onNodeItemSelected()})},onNodeItemSelected:function(e){this.model.get("childrenCount")>0&&0===this.model.get("children").length?(this.toggleOpenState(),this.setLoadingState(),this.loadChildren()):this.toggleOpenState()},loadChildren:function(){if(this.loadChildrenInternally){this.isModelLoading=!0,this.getChildrenLoadParams.itemId=this.model.get("itemId"),this.specifyDepth&&(this.getChildrenLoadParams.depth=this.model.get("depth")+1),this.model.loadParams=this.getChildrenLoadParams;var t=e.getBasicLoadOptions();this.model.load(t)}else this.trigger("tree:loadChildren",this.model)},setLoadingState:function(){var e=$(this.el).find("> "+this.nodeChildrenEL),t=this,i=Number(this.model.get("childrenCount"))*this.nodeItemHeight,n=(this.model.get("depth")+1)*this.depthIndent,s="<li class='loading' style='margin-left:"+n+"px;'></li>";e.html(s),this.loaderElId=e,e.find(".loading").animate({height:i},this.collapseSpeed,function(){t.isModelLoading&&t.showLoader()})},toggleOpenState:function(){this.model.get("isOpen")===!0?(this.closeNode(),this.model.set("isOpen",!1)):(this.openNode(),this.model.set("isOpen",!0))},closeNode:function(){if(this.showArrowEL){var e=$(this.el).find(" > "+this.nodeItemEL).find(this.arrowEL+" > div");e.removeClass("open"),this.model.get("childrenCount")>0?e.addClass("closed"):e.addClass("closedNoChildren")}$(this.el).find("> "+this.nodeChildrenEL).slideUp(this.collapseSpeed).promise().always(this.onSlideAnimationPromise)},openNode:function(){if(this.showArrowEL){var e=$(this.el).find(" > "+this.nodeItemEL).find(this.arrowEL+" > div");e.removeClass("closed"),e.addClass("open")}$(this.el).find("> "+this.nodeChildrenEL).slideDown(this.collapseSpeed).promise().always(this.onSlideAnimationPromise)},onSlideAnimationPromise:function(){},render:function(){$(this.el).html(this.template(this.getTemplateData())),this.initialiseEvents(),this.addChildrenInstances(),this.model.get("isOpen")===!0&&(this.model.get("childrenCount")>0&&0===this.model.get("children").length?this.closeNode():this.openNodePostRender()),null!==this.additionalRenderFunction&&this.additionalRenderFunction(this)},addChildrenInstances:function(){if(null===this.model.get("children")||this.model.get("children").length<=0)return!1;var e=$(this.el).find("> "+this.nodeChildrenEL),t=e.find(".loading"),i=this.options;i.el=null;var n=this;_.each(this.model.get("children").models,function(s,o){i.model=s;var r=new this.treeView(i);r.render(),e.append(r.$el),t&&t.css("height",t.outerHeight()-this.nodeItemHeight),n.childTreeViews.push(r)},this)},onChildrenLoaded:function(){this.isModelLoading=!1,this.removeSpinner();var e=$(this.el).find("> "+this.nodeChildrenEL);this.addChildrenInstances(),e.find(".loading").remove()},onItemDelete:function(){this.model.onDestroy(),this.destroy()},getTemplateData:function(){var e=this.model.toJSON();return e.depthIndent=this.depthIndent,e.nodeItemTemplate=_.template(this.getNodeItemTemplate())(e),e},getNodeItemTemplate:function(){return this.nodeItemTemplate},openNodePostRender:function(){this.openNode()},showLoader:function(){t.prototype.showLoader.apply(this)},removeSpinner:function(){t.prototype.removeSpinner.apply(this)},positionSpinner:function(){if(this.spinnerEL&&this.showSpinner){this.spinnerEL.css("position","relative");var e=Math.floor($(this.loaderElId).outerWidth()/2);this.spinnerEL.css("left",e+"px");var t=Math.floor($(this.loaderElId).outerHeight()/2);this.spinnerEL.css("top",-t+"px")}},onSelectedStateChange:function(){this.model.get("isSelected")?$(this.el).find("> .tree-node-item").addClass("selected"):$(this.el).find("> .tree-node-item").removeClass("selected")},onAdditionalNodeStateParamsChange:function(){this.model.get(this.additionalNodeStateParams)===this.additionalNodeStateValue?$(this.el).find("> .tree-node-item").addClass(this.additionalNodeStateSelector):$(this.el).find("> .tree-node-item").removeClass(this.additionalNodeStateSelector)},destroy:function(){for(;this.childTreeViews.length>0;){var e=this.childTreeViews.pop();null!==e&&(e.destroy(),e=null)}null!==this.model&&(this.model.unbind("change:children",this.onChildrenLoaded,this),this.stopListening(this.model,"change:isSelected",this.onSelectedStateChange,this),this.stopListening(this.model,"deleteSuccess",this.onItemDelete,this),this.model=null),this.remove(),t.prototype.destroy.apply(this)}});return s}),define("text!js/views/sectionsStack/examples/sections/PrimarySection.html",[],function(){return'\r\n<div class="primary-section-example">\r\n    <h4>Example of primary content as a tree</h4>\r\n    <div class="tree-container"></div>\r\n</div>\r\n\r\n'}),define("js/views/sectionsStack/examples/sections/PrimarySectionView",["dataStore","js/views/sectionsStack/section/BaseSectionView","js/views/tree/TreeView","text!js/views/sectionsStack/examples/sections/PrimarySection.html"],function(e,t,i,n){var s=t.extend({name:"PrimarySection",title:"Section title",nullModelMessage:"There is currently no item selected",treeView:null,initialize:function(e){t.prototype.initialize.apply(this,[e])},events:{"click .tree-node-item .active-select-area":"onItemSelected"},requestData:function(){var e=[];this.model.loadParams={loadType:"getTreeRoot",itemId:0},e.push(this.model),t.prototype.requestData.apply(this,[e])},renderSectionsContent:function(){var e=_.template(n);this.contentEL.html(e({})),this.initialiseTreeView()},initialiseTreeView:function(){this.treeView=new i({el:$(this.el).find(".tree-container"),model:this.model,openCloseNodeItem:!1,openCloseArrowOnly:!0,getChildrenLoadParams:{loadType:"getChildren"},additionalModelListenersHandlers:[{listener:"change:genericCount",handler:this.onTreeViewGenericCountChange}]}),this.treeView.render()},onItemSelected:function(e){var t=$(e.currentTarget).closest(".tree-node-item");this.trigger("sectionStackView:itemSelect",t.attr("data-id"),this.index)},onTreeViewGenericCountChange:function(e,t){var i='[data-id="'+e.get("itemId")+'"]';$(i).find(".cel-generic-count").html(e.get("genericCount"))},setAdditionalViewItemHeights:function(e){this.contentEL.css("min-height",e)}});return s}),define("text!js/views/sectionsStack/examples/sections/SecondarySection.html",[],function(){return'\r\n<div class="secondary-section-example">\r\n    <h4>Item <%= displayName %></h4>\r\n    <form>\r\n        <label for="generic-count-increment">Increment the item\'s count</label>\r\n        <input name="generic-count-increment" type="number" step="1" value="<%= genericCount %>" <% if(!canEdit){ %> disabled readonly<% } %>>\r\n    </form>\r\n</div>\r\n\r\n'}),define("js/views/sectionsStack/examples/sections/SecondarySectionView",["dataStore","js/views/sectionsStack/section/BaseSectionView","text!js/views/sectionsStack/examples/sections/SecondarySection.html"],function(e,t,i){var n=t.extend({name:"Secondary Section",title:"Section title",nullModelMessage:"There is currently no item selected",initialize:function(e){t.prototype.initialize.apply(this,[e])},events:{"change form":"onFormChange"},renderSectionsContent:function(){var e=_.template(i);null!==this.model?this.contentEL.html(e(this.model.toJSON())):this.contentEL.html(this.getNoDataMessageHTML(this.nullModelMessage))},onFormChange:function(e){this.model.set("genericCount",Number($(this.el).find("form > input").val()))}});return n}),define("js/views/sectionsStack/examples/DualFocusStackPageView",["dataStore","js/views/sectionsStack/BaseSectionsStackPageView","js/views/sectionsStack/examples/sections/PrimarySectionView","js/views/sectionsStack/examples/sections/SecondarySectionView"],function(e,t,i,n){var s=t.extend({name:"Dual-focus stack page view example",articleId:"basePageSectionsStackContent",gridClass:"page-section-stack-grid",gridType:"dual-focus",currentDefaultFocusedIndex:0,currentFocusedIndex:0,initialize:function(e){t.prototype.initialize.apply(this,[e])},initialiseModel:function(){},initialiseSectionsStack:function(){this.sectionsStack.push({view:new i({isOpen:!0,restrictHeightToScreen:!1,showHeader:!1,model:e.get("tree")}),"class":"primary-dual",ordinal:1}),this.sectionsStack.push({view:new n({isOpen:!1,restrictHeightToScreen:!0}),"class":"secondary-dual",ordinal:2})},events:{},addSectionsStackViewsListeners:function(e,t){switch(t){case 0:this.listenTo(e,"sectionStackView:itemSelect",this.onSectionItemSelected,this);break;case 1:this.listenTo(e,"sectionStackView:openClose",this.onSectionViewOpenClose,this)}},removeSectionsStackViewsListeners:function(e,t){switch(t){case 0:this.stopListening(e,"sectionStackView:itemSelect",this.onSectionItemSelected);break;case 1:this.stopListening(e,"sectionStackView:openClose",this.onSectionViewOpenClose)}},onSectionItemSelected:function(t,i){if(0===i){var n=e.get("tree").getTreeItem(Number(t));this.sectionsStack[1].view.updateModel(n)}}});return s}),define("js/views/sectionsStack/examples/SliderStackPageView",["dataStore","js/views/sectionsStack/BaseSectionsStackPageView","js/views/sectionsStack/examples/sections/PrimarySectionView","js/views/sectionsStack/examples/sections/SecondarySectionView"],function(e,t,i,n){var s=t.extend({name:"Slider stack page view example",gridType:"slider",currentFocusedIndex:0,initialize:function(e){t.prototype.initialize.apply(this,[e])},initialiseSectionsStack:function(){this.sectionsStack.push({view:new i({isOpen:!0,restrictHeightToScreen:!1,showHeader:!1}),"class":"secondary-slider",ordinal:1}),this.sectionsStack.push({view:new n({isOpen:!1,restrictHeightToScreen:!0}),"class":"secondary-slider",ordinal:2})},events:{},addSectionsStackViewsListeners:function(e,t){switch(t){case 0:this.listenTo(e,"sectionStackView:itemSelect",this.onSectionItemSelected,this);break;case 1:this.listenTo(e,"sectionStackView:openClose",this.onSectionViewOpenClose,this)}},removeSectionsStackViewsListeners:function(e,t){switch(t){case 0:this.stopListening(e,"sectionStackView:itemSelect",this.onSectionItemSelected);break;case 1:this.stopListening(e,"sectionStackView:openClose",this.onSectionViewOpenClose)}},onSectionItemSelected:function(e,t){if(0===t){var i=new Backbone.Model({displayName:"Item "+e,id:e});this.sectionsStack[1].view.updateModel(i)}}});return s}),define("text!js/views/courses/Courses.html",[],function(){return'<article class="page-container">\r\n   <header>\r\n        <div class="article-header-grid">\r\n            <div class="header-text">\r\n                <h2>Courses</h2>           \r\n            </div>\r\n            <div class="admin-button-wrapper">\r\n                <a href="index.html#defaultpage" class="action-button" tabindex="0" role="button">Back to default page</a>\r\n            </div>\r\n        </div>\r\n    </header>\r\n\r\n    \r\n    <section class="transactions">\r\n        <div class="content">\r\n            <h3>BOOM</h3>\r\n        </div>\r\n    </section>\r\n    \r\n</article>'}),define("js/views/courses/CoursesPageView",["dataStore","js/views/PageView","text!js/views/courses/Courses.html"],function(e,t,i){var n=t.extend({name:"Courses",initialize:function(e){t.prototype.initialize.apply(this,[e]),this.template=_.template(i)},events:{},renderPageContent:function(){$(this.el).html(this.template())}});return n}),define("example/exampleRouter",["js/router","dataStore","js/views/sectionsStack/examples/DualFocusStackPageView","js/views/sectionsStack/examples/SliderStackPageView","js/views/courses/CoursesPageView"],function(e,t,i,n,s){var o=e.extend({routes:{myCourses:"showPage",courses:"showPage",dualFocusStack:"showSectionsStackPage",sliderStack:"showSectionsStackPage",error:"showError","*actions":"defaultView"},switchableViews:["DualFocusStackPageView","SliderStackPageView","CoursesPageView"],initialize:function(){e.prototype.initialize.apply(this)},showPage:function(){var e=window.location.href,t=e.substr(e.lastIndexOf("#")+1),i="";switch(t){case"myCourses":i=s;break;case"courses":i=s}this.switchView(i,null,!0)},showSectionsStackPage:function(){var e=window.location.href,t=e.substr(e.lastIndexOf("#")+1),s="";switch(t){case"dualFocusStack":s=i;break;case"sliderStack":s=n}this.switchView(s,null,!0)},showError:function(){},switchView:function(t,i,n){e.prototype.switchView.apply(this,[t,i])},defaultView:function(){window.location.hash="courses"}}),r=function(){new o;Backbone.history.start()};return{initialize:r}}),define("example/exampleApp",["jquery","underscore","backbone","example/exampleRouter"],function(e,t,i,n){var s=function(){n.initialize()};return{initialize:s}}),require.config({baseUrl:"../",paths:{dataStore:"example/js/data/ExampleDataStore",jquery:"externalLibraries/jquery/jquery-1.12.3.min",underscore:"externalLibraries/underscore/underscore-min",backbone:"externalLibraries/backbone/backbone-min",text:"externalLibraries/require/text",spinner:"externalLibraries/spin/spin.min"}}),require(["example/exampleApp"],function(e){e.initialize()}),define("example/exampleMain",function(){});
//# sourceMappingURL=exampleMain.js.map